trigger: none

pool: 'Dedicated'

resources:
  pipelines:
  - pipeline: azure-landing-zones.Validate
    source: azure-landing-zones.Validate
    trigger: 
      tags:
      - '*'

stages: 
- stage: DeployPrdPlatform
  jobs:
  - job: DeployPrdPlatformBicep
    steps:
      - task: AzureCLI@2
        displayName: DeployPrdPlatformBicep
        inputs:
          azureSubscription: 'tenant-mgmt-root'
          scriptType: 'pscore'
          scriptLocation: 'inlineScript'
          inlineScript: |
            az deployment tenant create `
              --template-file bicep/platform.bicep `
              --location 'uksouth' `
              --parameters @params/platform.prd.json